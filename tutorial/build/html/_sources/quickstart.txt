.. _quickstart:

*******************
Quickstart Tutorial
*******************
This quickstart tutorial is a brief task-oriented example showing the shortest path to a metadata dynamically colored tree that can be manipulated.

For this quickstart (and the full tutorial) we are going to use the tree and related metadata from the paper "Forensic identification using skin bacterial communities‚Äù published in 2010 in PNAS by Noah Fierer et al.

Files needed
------------
All of the files you need to complete this tutorial can be found in the examples directory in the main directory you checked out from svn. 

tutorial_data (.tep)
^^^^^^^^^^^^^^^^^^^^
This file is a Topiary Explorer Project file (.tep) that was created for use in this tutorial. It contains information about the tree and related metadata.

Or

Newick-format tree (.tre)
^^^^^^^^^^^^^^^^^^^^^^^^^
This file contains a tree in newick_ format with tip labels and branch lengths.

OTU metadata (Tab-delimited .txt)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
This file is generated by the user and contains metadata related to each OTU. This file is not necessary if the user only wishes to color by related sample metadata. 

OTU Abundance Table (Tab-delimited .txt)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
This file is generated using the QIIME_ pipeline. Neither this file nor the sample mapping is needed if the user only wishes to color by OTU metadata.

Sample Mapping File (Tab-delimited .txt)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
The mapping file is generated by the user. This file contains all of the information about the samples necessary to perform the data analysis.

Step 1. Running TopiaryExplorer
-------------------------------
Navigate to the /main directory after checking out the package from SVN.

To run TopiaryExplorer::
	
	javaws topiaryexplorer.jnlp

When successfully run, you should get a window that looks like the following.

.. figure::  _images/blank.png
   :align:   center

   A newly opened TopiaryExplorer window.

Step 2. Opening the .tep file
-----------------------------
Using the Open Project button located at the top of the TopiaryExplorer window, navigate to the examples folder containing :file:`keyboard.tep` and open the file.

.. figure::  _images/open_project.png
   :align:   center

   A newly opened project.

Step 3. Uncollapsing the tree
-----------------------------
Using the collapse tree toolbar located near the top of the new TreeWindow, drag the slider to the right to fully uncollapse the tree.

Step 4. Editing & saving metadata
---------------------------------
In the TopiaryExplorer window, you will find a button in the top right corner of each metadata table. This button allows you to add new columns to a table or to save a table as tab delimited text.

In the Sample Metadata Mapping tab, add a new column by combining the columns Individual and Source. If you scroll to the right you will see this column at the end.

Now save your edited Sample Metadata Mapping table as tab delimited text.

.. figure::  _images/add_column.png
   :align:   center

   Add column dialog.

Step 5. Coloring the tree
-------------------------
To color the tree's branches, open the branch panel of the Tree Toolbar which is located on the left side of the TreeWindow. Click the "Color By..." button and select a sample metadata category to color by, such as "Individual". 

By default each option for the category will be colored gray. In the TopiaryExplorer window use the Color Key to select the desired colors. The small boxes in the same row as the intended option are used to show the current color, and when clicked will change the color of the corresponding option. 

To reproduce the images shown in this tutorial, color the DM option blue, the NF option red and the RK option green. 

.. figure::  _images/color_by.png
   :align:   center

   A tree colored by metadata.

Step 6. Opening a subtree
-------------------------
In order to study the tree more carefully, you may want to focus on smaller subtrees of a larger tree.

To view a subtree more closely, right click on the root node of the subtree of interest and then click View Subtree in new Window.

.. figure::  _images/view_subtree.png
   :align:   center

   Subtree viewed in a new window.

Step 7. Pruning the tree
------------------------
To remove unwanted branches, use the prune tree button at the top of the tree toolbar.

In the subtree window, we are going to remove branches based on sample metadata. Click the prune tree button, then select the metadata radio button, followed by the sample metadata radio button, and then choose a field to prune by. Since we already have the trees colored by individual, select this field, and then some value.

.. figure::  _images/prune_dialog.png
   :align:   left

When you click prune, you should see that all of the branches that were colored by whichever value you chose have now been pruned.

.. figure::  _images/pruned.png
   :align:   left

Step 8. Saving a new project
----------------------------
To save your modified metadata and trees, click the Save Project button at the top of the TopiaryExplorer window.

.. _newick: http://en.wikipedia.org/wiki/Newick_format
.. _QIIME: http://qiime.org
